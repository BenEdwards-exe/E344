Version 4
SHEET 1 1824 680
WIRE -1248 -976 -1376 -976
WIRE -1376 -928 -1376 -976
WIRE -1120 -864 -1136 -864
WIRE -640 -848 -640 -880
WIRE -416 -848 -416 -880
WIRE -2320 -832 -2320 -864
WIRE -1376 -832 -1376 -848
WIRE -1136 -832 -1136 -864
WIRE -1248 -816 -1248 -976
WIRE -1168 -816 -1248 -816
WIRE -1040 -800 -1104 -800
WIRE -1168 -784 -1312 -784
WIRE -416 -752 -416 -768
WIRE -272 -752 -416 -752
WIRE -224 -752 -272 -752
WIRE -1136 -736 -1136 -768
WIRE -640 -736 -640 -768
WIRE -512 -736 -640 -736
WIRE -416 -736 -416 -752
WIRE -272 -736 -272 -752
WIRE -1456 -720 -1456 -784
WIRE -832 -656 -976 -656
WIRE -688 -656 -832 -656
WIRE -512 -656 -512 -736
WIRE -464 -656 -512 -656
WIRE -272 -656 -272 -672
WIRE -976 -640 -976 -656
WIRE -832 -640 -832 -656
WIRE -1456 -624 -1456 -640
WIRE -1312 -624 -1312 -784
WIRE -1312 -624 -1456 -624
WIRE -1456 -608 -1456 -624
WIRE -416 -608 -416 -640
WIRE -640 -592 -640 -640
WIRE -976 -544 -976 -560
WIRE -832 -544 -832 -560
WIRE -1456 -512 -1456 -528
WIRE -832 -512 -1120 -512
WIRE -688 -512 -832 -512
WIRE -832 -496 -832 -512
WIRE -1120 -416 -1120 -512
WIRE -832 -400 -832 -416
WIRE -640 -400 -640 -496
WIRE -672 -240 -720 -240
WIRE -496 -240 -608 -240
WIRE -400 -240 -432 -240
WIRE -816 -208 -816 -240
WIRE -560 -128 -560 -160
WIRE -1008 -112 -1072 -112
WIRE -816 -112 -816 -128
WIRE -816 -112 -944 -112
WIRE -592 -112 -816 -112
WIRE -400 -96 -400 -240
WIRE -400 -96 -528 -96
WIRE -304 -96 -400 -96
WIRE -592 -80 -656 -80
WIRE -560 -32 -560 -64
WIRE -1008 -16 -1056 -16
WIRE -720 -16 -720 -240
WIRE -720 -16 -944 -16
WIRE -656 -16 -656 -80
WIRE -656 -16 -720 -16
WIRE -816 0 -816 -112
WIRE -720 0 -720 -16
WIRE -1504 48 -1504 16
WIRE -1392 48 -1392 16
WIRE -816 112 -816 80
WIRE -720 112 -720 80
WIRE -1504 160 -1504 128
WIRE -1392 160 -1392 128
FLAG -2320 -944 Input
IOPIN -2320 -944 Out
FLAG -1904 -1040 0
FLAG -2320 -752 0
FLAG -2320 -1056 0
FLAG -1264 -1248 ToInputADC
IOPIN -1264 -1248 Out
FLAG -1088 -1248 ToBatteryADC
IOPIN -1088 -1248 Out
FLAG -1904 -1200 5V
IOPIN -1904 -1200 Out
FLAG -2320 -1216 Battery
IOPIN -2320 -1216 Out
FLAG -1504 -1248 Battery
IOPIN -1504 -1248 Out
FLAG -1376 -1248 Input
IOPIN -1376 -1248 Out
FLAG -1120 -864 5V
IOPIN -1120 -864 Out
FLAG -1136 -736 0
FLAG -1456 -784 5V
IOPIN -1456 -784 Out
FLAG -1456 -512 0
FLAG -1376 -832 0
FLAG -1040 -800 Out
IOPIN -1040 -800 Out
FLAG -640 -880 5V
IOPIN -640 -880 Out
FLAG -832 -544 0
FLAG -832 -400 0
FLAG -640 -400 0
FLAG -416 -608 0
FLAG -416 -880 5V
IOPIN -416 -880 Out
FLAG -976 -544 0
FLAG -224 -752 Load_input
IOPIN -224 -752 Out
FLAG -1120 -336 0
FLAG -272 -656 0
FLAG -560 -160 5V
IOPIN -560 -160 Out
FLAG -560 -32 0
FLAG -816 -240 5V
IOPIN -816 -240 Out
FLAG -720 112 0
FLAG -816 112 0
FLAG -1056 -16 SET
IOPIN -1056 -16 In
FLAG -1072 -112 RESET
IOPIN -1072 -112 In
FLAG -304 -96 USER_IN
IOPIN -304 -96 Out
FLAG -1504 160 0
FLAG -1392 160 0
FLAG -1504 16 SET
IOPIN -1504 16 In
FLAG -1392 16 RESET
IOPIN -1392 16 In
SYMBOL voltage -2320 -960 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PWL file=InputPWL.csv
SYMBOL voltage -2320 -1152 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 98 Left 2
SYMATTR Value PWL file=BatteryPWL.csv
SYMATTR InstName V2
SYMBOL voltage -1904 -1136 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL voltage -2320 -848 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(-50m 50m 0 1n 1n 0.5m 1m)
SYMBOL res -1920 -1216 R0
SYMATTR InstName RSense5V
SYMATTR Value 1µ
SYMBOL res -2336 -1232 R0
SYMATTR InstName RSenseBattery
SYMATTR Value 1µ
SYMBOL OpAmps\\LTC6079 -1136 -800 R0
SYMATTR InstName U1
SYMBOL res -1472 -736 R0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL res -1472 -624 R0
SYMATTR InstName R2
SYMATTR Value 30k
SYMBOL voltage -1376 -944 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -149 -90 Left 2
SYMATTR InstName V5
SYMATTR Value PWL file=AmbientPWL.csv
SYMBOL nmos -688 -736 R0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL res -656 -864 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL nmos -688 -592 R0
SYMATTR InstName M2
SYMATTR Value 2N7002
SYMBOL nmos -464 -736 R0
SYMATTR InstName M3
SYMATTR Value 2N7002
SYMBOL res -848 -656 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res -848 -512 R0
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -432 -864 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL voltage -976 -656 R0
WINDOW 3 -1032 506 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value PWL(0 0 0.2 0 0.2001 5 0.6 5 0.6001 0 0.7 0 0.7001 5)
SYMBOL voltage -1120 -432 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value PWL(0 0 0.3 0 0.3001 5 0.5 5 0.5001 0 0.9 0 0.9001 5)
SYMBOL cap -288 -736 R0
SYMATTR InstName C1
SYMATTR Value 1n
SYMBOL OpAmps\\LTC6079 -560 -96 R0
SYMATTR InstName U2
SYMBOL diode -432 -256 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode -608 -256 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res -736 -16 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res -832 -16 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res -832 -224 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL diode -1008 -96 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL diode -1008 0 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL voltage -1504 32 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PWL(0 0 0.1 0 0.1001 5 0.2 5 0.2001 0 0.4 0 0.4001 5 0.6 5 0.6001 0)
SYMBOL voltage -1392 32 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value PWL(0 0 0.25 0 0.25001 5 0.27 5 0.27001 0)
TEXT -2152 -1360 Left 2 !.tran 0 {transtop} 0
TEXT -2152 -1392 Left 2 !.include A6cfg.txt
TEXT -2352 -1392 Left 2 ;Config file:
TEXT -2352 -1360 Left 2 ;Analysis setup:
TEXT -1552 -1400 Left 2 ;=============================\nREPLACE WITH YOUR DETAILS\nB,J. Edwards.,  22738002\n=============================
LINE Normal -1584 -1424 -1584 -704 2
LINE Normal -2368 -1424 -1584 -1424 2
LINE Normal -1584 -704 -2368 -704 2
LINE Normal -1584 -720 -1584 -720 2
LINE Normal -2368 -1424 -2368 -704 2
