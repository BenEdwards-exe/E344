Version 4
SHEET 1 3248 1828
WIRE -672 80 -672 64
WIRE 1584 80 1584 48
WIRE 944 96 896 96
WIRE 1040 96 1008 96
WIRE 1168 128 1168 112
WIRE 1040 144 1040 96
WIRE 1136 144 1040 144
WIRE 128 160 128 144
WIRE -672 176 -672 160
WIRE -544 176 -544 128
WIRE -432 176 -432 128
WIRE -320 176 -320 144
WIRE -224 176 -224 144
WIRE 944 192 896 192
WIRE 1040 192 1040 144
WIRE 1040 192 1008 192
WIRE 1584 192 1584 160
WIRE 1040 240 1040 192
WIRE 1136 240 1136 144
WIRE 1248 240 1136 240
WIRE 352 256 320 256
WIRE 1408 256 1312 256
WIRE 1424 256 1408 256
WIRE 1520 256 1424 256
WIRE 496 272 416 272
WIRE 1168 272 1168 208
WIRE 1248 272 1168 272
WIRE 1424 272 1424 256
WIRE -672 288 -672 256
WIRE -544 288 -544 256
WIRE -432 288 -432 256
WIRE -320 288 -320 256
WIRE -224 288 -224 256
WIRE 128 288 128 240
WIRE 352 288 128 288
WIRE 1584 288 1584 256
WIRE 128 320 128 288
WIRE 1040 336 1040 320
WIRE 1168 336 1168 272
WIRE 1424 368 1424 352
WIRE 1520 368 1520 256
WIRE 1536 368 1520 368
WIRE 128 416 128 400
WIRE 1168 432 1168 416
WIRE 1584 432 1584 384
WIRE 1328 768 1328 752
WIRE -352 816 -400 816
WIRE -240 816 -288 816
WIRE -144 816 -176 816
WIRE -496 832 -496 816
WIRE 960 832 960 816
WIRE 432 848 432 800
WIRE 1232 848 1232 816
WIRE 1328 912 1328 848
WIRE 1376 912 1328 912
WIRE -608 928 -640 928
WIRE -496 928 -496 912
WIRE -496 928 -544 928
WIRE -304 928 -496 928
WIRE 1536 928 1440 928
WIRE 1552 928 1536 928
WIRE -144 944 -144 816
WIRE -144 944 -240 944
WIRE -96 944 -144 944
WIRE 960 944 960 912
WIRE 1088 944 960 944
WIRE 1232 944 1232 928
WIRE 1376 944 1232 944
WIRE -304 960 -352 960
WIRE 1536 960 1536 928
WIRE 336 976 288 976
WIRE 432 976 432 928
WIRE 432 976 400 976
WIRE 1088 976 1088 944
WIRE 1136 976 1088 976
WIRE 1232 976 1232 944
WIRE 1232 976 1200 976
WIRE 1328 976 1328 912
WIRE -608 1024 -640 1024
WIRE -400 1024 -400 816
WIRE -400 1024 -544 1024
WIRE -352 1024 -352 960
WIRE -352 1024 -400 1024
WIRE 432 1024 432 976
WIRE 512 1024 432 1024
WIRE 912 1024 832 1024
WIRE -496 1056 -496 928
WIRE -400 1056 -400 1024
WIRE 1536 1056 1536 1040
WIRE 336 1072 288 1072
WIRE 432 1072 432 1024
WIRE 432 1072 400 1072
WIRE 1152 1072 1136 1072
WIRE 1232 1072 1232 976
WIRE 1232 1072 1200 1072
WIRE 1328 1072 1328 1056
WIRE 960 1136 960 1040
WIRE -496 1152 -496 1136
WIRE -400 1152 -400 1136
FLAG -672 288 0
FLAG -672 64 5V
IOPIN -672 64 Out
FLAG 384 240 5V
IOPIN 384 240 Out
FLAG 384 304 0
FLAG 128 416 0
FLAG 128 144 5V
IOPIN 128 144 Out
FLAG -224 288 0
FLAG 496 272 isLight
IOPIN 496 272 BiDir
FLAG -272 912 5V
IOPIN -272 912 Out
FLAG -272 976 0
FLAG -496 816 5V
IOPIN -496 816 Out
FLAG -496 1152 0
FLAG -400 1152 0
FLAG -640 928 Button_reset
IOPIN -640 928 In
FLAG -640 1024 Button_set
IOPIN -640 1024 In
FLAG -96 944 User_control
IOPIN -96 944 BiDir
FLAG -544 288 0
FLAG -432 288 0
FLAG -544 128 Button_reset
IOPIN -544 128 In
FLAG -432 128 Button_set
IOPIN -432 128 In
FLAG 432 800 5V
IOPIN 432 800 Out
FLAG 512 1024 Load_input
IOPIN 512 1024 BiDir
FLAG 288 1072 Beetle_PWM
IOPIN 288 1072 In
FLAG 288 976 User_control
IOPIN 288 976 BiDir
FLAG -320 288 0
FLAG -320 144 Beetle_PWM
IOPIN -320 144 In
FLAG 960 1136 0
FLAG 1136 1072 Load_input
IOPIN 1136 1072 BiDir
FLAG 960 816 5V
IOPIN 960 816 Out
FLAG 1232 816 5V
IOPIN 1232 816 Out
FLAG 832 1024 isLight
IOPIN 832 1024 BiDir
FLAG 1552 928 Load_control
IOPIN 1552 928 Out
FLAG 1408 896 5V
IOPIN 1408 896 Out
FLAG 1408 960 0
FLAG 1536 1056 0
FLAG 1328 752 5V
IOPIN 1328 752 Out
FLAG 1328 1072 0
FLAG 1040 336 0
FLAG 896 192 isLight
IOPIN 896 192 BiDir
FLAG 896 96 User_control
IOPIN 896 96 BiDir
FLAG 1584 48 5V
IOPIN 1584 48 Out
FLAG 1584 432 0
FLAG 1280 224 5V
IOPIN 1280 224 Out
FLAG 1280 288 0
FLAG 1168 112 5V
IOPIN 1168 112 Out
FLAG 1168 432 0
FLAG 1424 368 0
FLAG 1408 256 Pilot_control
FLAG 128 288 V_ref_amb
FLAG -224 144 V_ambient
IOPIN -224 144 In
FLAG 320 256 V_ambient
IOPIN 320 256 In
SYMBOL OpAmps\\LTC6079 384 272 R0
SYMATTR InstName U1
SYMBOL diode -176 800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL voltage -672 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL res -656 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RSense5V
SYMATTR Value 1µ
SYMBOL res 112 144 R0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL res 112 304 R0
SYMATTR InstName R2_pot
SYMATTR Value 25k
SYMBOL voltage -224 160 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 4.5 0.3 0.2 0.3 0.5 0.5 1.5 0.6 2 0.7 2 0.8 0.5 0.9 3)
SYMATTR InstName V_amb
SYMBOL OpAmps\\LTC6079 -272 944 R0
SYMATTR InstName U2
SYMBOL diode -288 800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res -512 816 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL diode -608 944 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL diode -608 1040 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL res -512 1040 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res -416 1040 R0
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL voltage -544 160 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 0 0.3 0 0.3001 5 0.325 5 0.325001 0 0.6 0 0.6001 5 0.8 5 0.8001 0)
SYMATTR InstName V2
SYMBOL voltage -432 160 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 0 0.1 0 0.1001 5 0.35 5 0.35001 0 0.9 0 0.9001 5)
SYMATTR InstName V3
SYMBOL diode 400 960 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL diode 400 1056 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL res 416 832 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL voltage -320 160 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 5 0.05 5 0.05001 0 0.07 0 0.07001 5)
SYMATTR InstName V4
SYMBOL nmos 912 944 R0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL res 944 816 R0
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL diode 1200 960 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D7
SYMATTR Value 1N4148
SYMBOL diode 1200 1056 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMBOL res 1216 832 R0
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL OpAmps\\LTC6079 1408 928 R0
SYMATTR InstName U3
SYMBOL res 1520 944 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 1312 960 R0
SYMATTR InstName R10
SYMATTR Value 220k
SYMBOL res 1312 752 R0
SYMATTR InstName R11
SYMATTR Value 220k
SYMBOL diode 944 112 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value 1N4148
SYMBOL diode 944 208 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D10
SYMATTR Value 1N4148
SYMBOL res 1024 224 R0
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL nmos 1536 288 R0
SYMATTR InstName M2
SYMATTR Value 2N7002
SYMBOL res 1568 64 R0
SYMATTR InstName R13
SYMATTR Value 1k
SYMBOL OpAmps\\LTC6079 1280 256 R0
SYMATTR InstName U4
SYMBOL res 1152 320 R0
SYMATTR InstName R14
SYMATTR Value 220k
SYMBOL res 1152 112 R0
SYMATTR InstName R15
SYMATTR Value 220k
SYMBOL res 1408 256 R0
SYMATTR InstName R16
SYMATTR Value 220k
SYMBOL LED 1568 192 R0
SYMATTR InstName D11
SYMATTR Value AOT-2015
TEXT -712 -120 Left 2 !.tran 0 {transtop} 0
TEXT -712 -160 Left 2 !.include A7cfg.txt
TEXT 152 64 Left 3 ;Ambient Light Sensor
TEXT 360 592 Left 3 ;LED Load Control
TEXT 1136 16 Left 3 ;Pilot Light Control
TEXT 136 -192 Left 4 ;=======================\nB.J., Edwards., 22738002\n=======================
RECTANGLE Normal -80 464 -864 -192 2
RECTANGLE Normal 624 32 -32 464
RECTANGLE Normal -864 560 1776 1248
RECTANGLE Normal 1760 -16 688 464
